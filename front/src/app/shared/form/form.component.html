<form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">
  <div [ngClass]="config.styles">
    <ng-container *ngFor="let field of config.fields">
      <div class="form-group">
        <label *ngIf="field.type !== 'checkbox'" [for]="field.name"
          class="block text-md font-medium text-gray-700 dark:text-gray-300">
          {{ field.label }}
        </label>
        <input *ngIf="field.type !== 'select' && field.type !== 'textarea' && field.type !== 'checkbox'"
          [id]="field.name" [type]="field.type" [formControlName]="field.name" [placeholder]="field.placeholder"
          class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-purple-400 focus:border-purple-400" />

        <div *ngIf="field.type === 'checkbox'" class="flex items-center">
          <input [id]="field.name" [type]="field.type" [formControlName]="field.name"
            class="w-4 h-4 text-primary border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-400 focus:border-purple-400" />
          <label [for]="field.name" class="ml-2 text-md font-medium text-gray-700 dark:text-gray-300">
            {{ field.label }}
          </label>
        </div>

        <textarea *ngIf="field.type === 'textarea'" [id]="field.name" [formControlName]="field.name"
          [placeholder]="field.placeholder"
          class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-400 focus:border-purple-400"></textarea>
        <select *ngIf="field.type === 'select'" [id]="field.name" [formControlName]="field.name"
          class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-400 focus:border-purple-400">
          <option *ngFor="let option of field.options" [value]="option">{{ option }}</option>
        </select>
        <div *ngIf="form.get(field.name)?.invalid && form.get(field.name)?.touched" class="text-red-600 mt-1 text-md">
          <div *ngIf="form.get(field.name)?.errors?.['required']">Ce champ est obligatoire.</div>
          <div *ngIf="form.get(field.name)?.errors?.['email']">Veuillez entrer une adresse e-mail valide.</div>
          <div *ngIf="form.get(field.name)?.errors?.['minlength']">Ce champ doit contenir au moins {{
            form.get(field.name)?.errors?.['minlength']?.requiredLength }} caractères.</div>
          <div *ngIf="form.get(field.name)?.errors?.['maxlength']">Ce champ doit contenir au plus {{
            form.get(field.name)?.errors?.['maxlength']?.requiredLength }} caractères.</div>
          <div *ngIf="form.get(field.name)?.errors?.['pattern']">
            <div *ngIf="form.get(field.name)?.errors?.['pattern'].requiredPattern === '/[a-z]/'">Le mot de passe doit
              contenir au moins une lettre minuscule.</div>
            <div *ngIf="form.get(field.name)?.errors?.['pattern'].requiredPattern === '/[A-Z]/'">Le mot de passe doit
              contenir au moins une lettre majuscule.</div>
            <div *ngIf="form.get(field.name)?.errors?.['pattern'].requiredPattern === '/[0-9]/'">Le mot de passe doit
              contenir au moins un chiffre.</div>
          </div>
          <div *ngIf="field.name === 'confirm_password' && form.get('confirm_password')?.errors?.['mismatch']">Les mots de passe ne correspondent pas.</div>
        </div>
      </div>
    </ng-container>
  </div>
  <div *ngIf="formSubmitted && hasFormErrors()" class="text-red-600 mt-1 text-md">
    Veuillez remplir tous les champs correctement.
  </div>
  <div class="form-group">
    <button type="submit"
      class="w-full px-6 py-2 rounded-full bg-primary text-white font-semibold hover:bg-primary-dark transition duration-300 disabled:bg-gray-400 dark:disabled:bg-gray-700">
      {{ config.submitLabel }}
    </button>
  </div>
</form>